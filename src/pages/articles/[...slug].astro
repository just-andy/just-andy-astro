---
import { getCollection, render } from "astro:content";
import FrontmatterLayout from "../../layouts/FrontmatterLayout.astro";
import Hero from "../../components/Hero.astro";
import Breadcrumbs from "../../components/Breadcrumbs.astro";

export async function getStaticPaths() {
  const articles = await getCollection("articles");
  return articles.map((article) => ({
    params: { slug: article.id },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await render(article);

const dateOptions: object = {
  year: "numeric",
  month: "long",
  day: "numeric",
};
---

<FrontmatterLayout
  frontmatter={article.data}
  title={article.data.title}
  description={article.data.summary}
>
  {}

  <Breadcrumbs section="articles" page={article.data.title} />
  <main
    class="prose | flow | article | content-grid"
    id="main-content"
  >
    <header class="article__header breakout">
      <div class="article__header--time">
        <time datetime={article.data.publishDate.toISOString()}>
          {article.data.publishDate.toLocaleDateString("en-GB", dateOptions)}
        </time>
      </div>
      <h1>{article.data.title}</h1>
      {
        article.data.summary && (
          <p class="article__header--subheading">{article.data.summary}</p>
        )
      }
    </header>

    <Content />

    <footer class="article__footer">
      <div class="tags">
        {article.data.keywords.join(", ")}
      </div>
    </footer>
  </main>
</FrontmatterLayout>
